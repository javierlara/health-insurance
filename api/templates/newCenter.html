<!DOCTYPE html>
<html>
  <head>
    <title>Nuevo Centro de Salud</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" media="screen">
    <style>
      .container {
        max-width: 1000px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Centro de Salud</h1>
      <form id='healthCentersForm' role="form" method='POST' action='/api/health_centers' enctype='application/json'>
        <div class="form-group">
            <input type="text" name="name" class="form-control" id="address-box" placeholder="Nombre" style="max-width: 300px;" autofocus required />
            <input type="text" name="address" class="form-control" id="address-box" placeholder="Dirección" style="max-width: 300px;" autofocus required />
            <input type="text" name="telephone" class="form-control" id="address-box" placeholder="Teléfono" style="max-width: 300px;" autofocus required />
        </div>
        <button type="submit" class="btn btn-default">Submit</button>
      </form>
      <br>
      {% for error in errors %}
        <h4>{{ error }}</h4>
      {% endfor %}
    </div>
    <script src="//code.jquery.com/jquery-2.2.1.min.js"></script>
    <script src="http://malsup.github.com/jquery.form.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <script type='text/javascript'>
{#        $(document).ready(function() {#}
{#            $('#healthCentersForm').ajaxForm({#}
{#                dataType: "json",#}
{#                contentType : "application/json"#}
{#            });#}
{#        });#}
        $("#healthCentersForm").submit(function(event) {
            event.preventDefault();
            var $form = $( this ), url = $form.attr( 'action' );
            var formData = JSON.stringify($form.serializeObject())
            $.ajax({
                type: "POST",
                url: url,
                data: formData,
                success: function() {
                    alert("success")
                    clearForm($form)
                },
                dataType: "json",
                contentType : "application/json"
            });
        });

        function clearForm(form) {
            form.find("input").val("")
        }

        $.fn.serializeObject = function()
        {
            var o = {};
            var a = this.serializeArray();
            $.each(a, function() {
                if (o[this.name] !== undefined) {
                    if (!o[this.name].push) {
                        o[this.name] = [o[this.name]];
                    }
                    o[this.name].push(this.value || '');
                } else {
                    o[this.name] = this.value || '';
                }
            });
            return o;
        };
    </script>
  </body>
</html>